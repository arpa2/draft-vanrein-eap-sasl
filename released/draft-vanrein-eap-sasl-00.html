<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Simple Authentication and Security Layers over the Extensible Authentication Protocol (EAP-SASL)</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Inner and Outer Identities"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Transporting SASL Frames over EAP"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Interactions with the EAP Lower Layer"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Key Derivation"/>
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Keying under EAP-SASL"/>
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Keying under EAP-TTLS"/>
<link href="#rfc.section.6" rel="Chapter" title="6 Efficiency Considerations"/>
<link href="#rfc.section.7" rel="Chapter" title="7 Privacy Considerations"/>
<link href="#rfc.section.8" rel="Chapter" title="8 Security Considerations"/>
<link href="#rfc.section.9" rel="Chapter" title="9 IANA Considerations"/>
<link href="#rfc.references" rel="Chapter" title="10 References"/>
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative References"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.1 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Van Rein, R." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-vanrein-eap-sasl-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2017-8-14" />
  <meta name="dct.abstract" content="This specification permits SASL authentication as an application of EAP.  This enhances SASL with several new protocols over which it can be used.  It enhances EAP with application-level credentials and mechanisms." />
  <meta name="description" content="This specification permits SASL authentication as an application of EAP.  This enhances SASL with several new protocols over which it can be used.  It enhances EAP with application-level credentials and mechanisms." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">Network Working Group</td>
  <td class="right">R. Van Rein</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">ARPA2.net</td>
</tr>
<tr>
  <td class="left">Intended status: Standards Track</td>
  <td class="right">August 14, 2017</td>
</tr>
<tr>
  <td class="left">Expires: February 15, 2018</td>
  <td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Simple Authentication and Security Layers over the Extensible Authentication Protocol (EAP-SASL)<br />
  <span class="filename">draft-vanrein-eap-sasl-00</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This specification permits SASL authentication as an application of EAP.  This enhances SASL with several new protocols over which it can be used.  It enhances EAP with application-level credentials and mechanisms.</p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on February 15, 2018.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2017 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<li>2.   <a href="#rfc.section.2">Inner and Outer Identities</a></li>
<li>3.   <a href="#rfc.section.3">Transporting SASL Frames over EAP</a></li>
<li>4.   <a href="#rfc.section.4">Interactions with the EAP Lower Layer</a></li>
<li>5.   <a href="#rfc.section.5">Key Derivation</a></li>
<ul><li>5.1.   <a href="#rfc.section.5.1">Keying under EAP-SASL</a></li>
<li>5.2.   <a href="#rfc.section.5.2">Keying under EAP-TTLS</a></li>
</ul><li>6.   <a href="#rfc.section.6">Efficiency Considerations</a></li>
<li>7.   <a href="#rfc.section.7">Privacy Considerations</a></li>
<li>8.   <a href="#rfc.section.8">Security Considerations</a></li>
<li>9.   <a href="#rfc.section.9">IANA Considerations</a></li>
<li>10.   <a href="#rfc.references">References</a></li>
<ul><li>10.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>10.2.   <a href="#rfc.references.2">Informative References</a></li>
</ul><li><a href="#rfc.authors">Author's Address</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a></h1>
<p id="rfc.section.1.p.1">EAP, or the Extensible Authentication Protocol, is a pluggable mechanism for the control of network or service access by users.  It is usually communicated with users during a login phase of IKEv2 [Section 3.16 of <a href="#RFC7296">[RFC7296]</a>], PPP [Section 3.2 of <a href="#RFC3748">[RFC3748]</a>], 802.1x [Section 3.3 of <a href="#RFC3748">[RFC3748]</a>] or PANA <a href="#RFC5191">[RFC5191]</a> and passed on to backend servers in a RADIUS attribute [Section 5.1 of <a href="#RFC2865">[RFC2865]</a>] or Diameter AVP [Section 8.14 of <a href="#RFC6733">[RFC6733]</a>] set aside for EAP.  Note that PPP is used in technologies like PPPoE, PPPoA, L2TP and PPTP; and that 802.1x is used in EAPOL authentication for wired networks, as well as for wireless ethernet where it is called WPA2; IKE is used to negotiate IPsec security associations.  In short, EAP is available in most places that grant network access.</p>
<p id="rfc.section.1.p.2">Although often used with password-based policies, EAP may also be used with more advanced cryptographic approaches.  What this specification adds, is a facility for the Simple Authentication and Security Layer, with a focus on the most generally used facilitation of client authentication.  Both EAP and SASL follow a request/response interaction, which makes their integration into EAP-SASL relatively straightforward.</p>
<p id="rfc.section.1.p.3">Typical applications of EAP are network access, while SASL is more oriented towards end-user applications.  There is no reason however, why the potential of SASL mechanisms should be held back from EAP.  What EAP stands to gain from this is an independently standardised and implemented set of authentication mechanisms; depending on implementation choices, these may be made to share credentials for end-user applications, which can be helpful when networks move into the user view, such as is the case with VPNs and single-user network logon (perhaps from a single-user machine).  What SASL stands to gain is the ability to be carried over widely used AAA backend protocols such as RADIUS and Diameter.  When a site is standardising its authentication on SASL, it is possible for both network access and end-user applications to isolate authentication sequences and relay them to a shared AAA backend.  This facilitates centralised management of identities and credentials.</p>
<p id="rfc.section.1.p.4">Some special attention is needed for one of the SASL mechanisms, namely Kerberos5 over GSSAPI.  This mechanism uses short-lived credentials, which may mean that a bootstrapping sequence is needed so these can be setup.  The work in progress on IAKERB <a href="#I-D.ietf-kitten-iakerb">[I-D.ietf-kitten-iakerb]</a> enhances GSSAPI with just this facility.  This is more general, and therefore better, than earlier work done on EAP-Kerberos <a href="#I-D.vanrein-eap-kerberos">[I-D.vanrein-eap-kerberos]</a>.  An explicit method for Kerberos over EAP is an improvement over current-day implementations that use the PAP method to pass the client password over RADIUS which then addresses a KDC by authenticating on behalf of the user.  It should be noted that such submission of user passwords contradicts Kerberos security design assumptions.</p>
<p id="rfc.section.1.p.5">There is a SASL method for EAP over GSSAPI <a href="#RFC7055">[RFC7055]</a>, which could be combined with this specification to form stacks like EAP-SASL-GSSAPI-EAP and SASL-GSSAPI-EAP-SASL, both of which seem useless and are unintended.  These stacks may however occur as a result of abstraction layers that are unaware of lower or higher abstraction layers.  Although not a sign of good design, this specification cannot forecast all possible uses, so it limits itself to stating that such stacks are NOT RECOMMENDED.</p>
<p id="rfc.section.1.p.6">The following Security Claims [Section 7.2 of <a href="#RFC3748">[RFC3748]</a>] are made for EAP-Kerberos:</p>
<pre>
Mechanism:                 SASL mechanisms with operator approval
Ciphersuite negotiation:   Only with supporting SASL mechanisms
Mutual authentication:     Only with supporting SASL mechanisms
Integrity protection:      No
Replay protection:         Only with supporting SASL mechanisms
Confidentiality:           No
Key derivation:            Yes, except with plaintext passwords
Key strength:              Follows SASL credential entropy
Dictionary attack protect: Follows SASL credential entropy
Fast reconnect:            No
Cryptographic binding:     No
Session independence:      Yes, ensured through fresh random salts
Fragmentation:             Yes
Channel binding:           No
</pre>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#inoutid" id="inoutid">Inner and Outer Identities</a></h1>
<p id="rfc.section.2.p.1">It is common for EAP to be encapsulated in a context that communicates an identity, independently of what the EAP does with it.  This identity is sometimes referred to as the "outer" identity, to contrast it with an "inner" identity negotiated within the EAP transport.  As an example, when EAP is transported in RADIUS or Diameter, there is commonly a User-Name attribute at the same level as the EAP-Message attribute holding an EAP packet; the contents of this User-Name would be the outer identity.</p>
<p id="rfc.section.2.p.2">Only the inner identities of EAP-SASL relate to authenticated identities, at least when EAP approves the exchange.  This remains true when EAP-SASL is wrapped inside of EAP-TTLS, as described below.</p>
<p id="rfc.section.2.p.3">An outer identity may be added for routing purposes alone, where the realm part of the User-Name serves to indicate a backend to route to.  In fact, for reasons of privacy, the outer identity often lacks the user name and may look like @example.com.</p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#frames" id="frames">Transporting SASL Frames over EAP</a></h1>
<p id="rfc.section.3.p.1">Messages from the SASL client to the server are sent in an EAP packet with Code set to Request.  What is called a client in SASL is referred to as a peer in EAP.  Challenges from the server to the SASL client are sent in EAP packets with Code set to Response.  Both the EAP packets, which shall be referred to as EAP Request and EAP Response respectively, will set Type to TBD, as assigned by IANA.  The Type-Data field in both an EAP Request and EAP Responses is referred to as EAP Payload below.  The names EAP Success and EAP Failure will be used to refer to an EAP packet with Code set to Success and Failure, respectively.</p>
<p id="rfc.section.3.p.2">The SASL specification <a href="#RFC4422">[RFC4422]</a> is often used with base64-encoding of binary data, to avoid problems of textual protocols.  EAP is a binary protocol, so it can carry binary content directly in EAP.  For this reason, no base64 or other mapping to text will be used.</p>
<p id="rfc.section.3.p.3">The EAP Payload consists of 20 bytes followed by the binary data for the SASL mechanism, the latter of which may be 0 bytes long.  The first 20 bytes hold the SASL mechanism name or an instruction.  Instructions are easily recognised because they start with an asterisk (U+002a).  Note that instructions are not valid SASL mechanism names; they are used to expand EAP with specific semantics of EAP-SASL.  The SASL mechanism name or instruction starts in the first byte of the EAP Payload and is padded with space characters (U+0020) to fill up the 20 bytes.  Note that according to the syntax of SASL names [Section 3.1 of <a href="#RFC4422">[RFC4422]</a>], 20 bytes can hold the longest SASL name.</p>
<p id="rfc.section.3.p.4">The instruction *RESET can be sent by EAP peers to terminate a current EAP session, if any; the EAP server responds with EAP Failure, which only counts as a failed session inasfar as one was currently active.  This form of termination is never used by the EAP server, which instead sends EAP Failure in its next EAP Response message.  The *RESET instruction is never followed by SASL mechanism data bytes.  The instruction SHOULD be used when the EAP Lower Layer is a multiplex of EAP links without explicit link ends, and it MAY be used when it uses a connection-less transport without any certainty about the remote peer's state (such as after a software restart on either end).  When no EAP interaction is taking place, the EAP Payload with this instruction has no effect.  On connection-less EAP transports, this instruction may be used to safely start an interaction after one side is restarted while the other may still keep state.  When an EAP Payload with this instruction is used, both its sender and recipient MUST discard any EAP-related state and forward the error to any other protocol layers that may depend on it.</p>
<p id="rfc.section.3.p.5">The instruction *DEFRAGMENT is used when an EAP Payload cannot be sent in one whole; any but the last EAP Payload is sent with this instruction.  It may be sent by the EAP peer or server when the MTU available for EAP is insufficient to carry a full EAP Reqeust or EAP Response.  The size of the data following this instruction and its padding to 20 bytes MUST be non-zero and should make the EAP Payload almost as large as the MTU will permit.  Upon receiving an EAP Payload with this instruction, it is held so that the next EAP Payload may be attached to it; the reconstituted EAP Payload will have its SASL mechanism name or instruction set to the first EAP Payload to follow without the *DEFRAGMENT instruction.  This reconsituted EAP Payload is then used instead of its constituent components, and processed as had it been sent without transport fragmentation.  The receiving party requests continuation with an EAP Request or Response (as implied by their role) with the *CONTINUE instruction and no appended bytes.</p>
<p id="rfc.section.3.p.6">The instruction *RANDOMSALT may be exchanged once before EAP Success or EAP Failure.  It is initially sent by the EAP peer, and results in the same instruction in an EAP server response.  Each party is allowed to send as much random bytes as it likes, but 16 bytes is the REQUIRED minimum and no more than the size of MSK/EMSK that could be generated from it, which means a maximum of 128 bytes under this specification.</p>
<p id="rfc.section.3.p.7">The first EAP Payload that names the SASL mechanism may just be 20 bytes in size, in which case its optional initial data is considered absent.  When a *DEFRAGMENT instruction precedes it, the optional initial data is considered present, even when it is 0 bytes long.  SASL requires distinction between  empty and absent initial data [Section 4 of <a href="#RFC3748">[RFC3748]</a>], which is implemented by these rules.</p>
<p id="rfc.section.3.p.8">The instruction *LISTMECHANISMS enables the EAP peer to obtain a list of server-supported SASL mechanism names.  The EAP Request with this instruction adds no data bytes; the EAP Response with this instruction adds supported SASL mechanism names separated by a space character (U+0020).  The use of this instruction is optional, at the discretion of the peer.  When sent, this exchange precedes the customary information.</p>
<p id="rfc.section.3.p.9">Any *DEFRAGMENT instructions preceding an EAP Success count as the optional data that a SASL mechanism may receive alongside a successful finish.  This even applies when the preceding instructions provide 0 bytes.  The absense of preceding *DEFRAGMENT instructions cause an EAP Success to be delivered to the EAP peer without such additional data.  Note the distinction between absense of additional data and empty but present This slightly contrived mechanism can fit carrier protocols that allow only one EAP Payload at a time, notably PPP [Section 2.2 of <a href="#RFC2284">[RFC2284]</a>] as well as others that depend on the EAP Success to be reported over EAP and not merely be derivable from this EAP-SASP instruction.  When EAP Failure is reported by the server, any preceding *DEFRAGMENT instructions from the server MUST be ignored, and silently discarded before delivery to the EAP peer.</p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#lower-layer" id="lower-layer">Interactions with the EAP Lower Layer</a></h1>
<p id="rfc.section.4.p.1">SASL requires a number of specifications from the protocol that embeds it.  Some of these can be resolved in EAP in a generic manner, as was done in the preceding section; this section pushes a few requirements to the layers below EAP, which we shall refer to as the EAP Lower Layer, for which some possibilities are enumerated in the Extensible Authentication Protocol (EAP) Registry maintained by IANA, while others such as RADIUS and Diameter are only defined by incorporation of EAP in their messages.</p>
<p id="rfc.section.4.p.2">The Identity field in an EAP header [Section 4 of <a href="#RFC3748">[RFC3748]</a>] is the only mechanism that can distinguish EAP packets, and it is used to match a Response to a Request.  Though it might be used to allow 128 or perhaps even 256 simultaneous EAP interactions, this is neither forbidden nor specified herein.  Instead, the RECOMMENDED place to implement concurrency is in the EAP Lower Layer; a PPP stream is always encapsulated into a session, as is the case for L2TP and PPPoE and even dialup networking; a RADIUS stream can include an EAP-Session-Id; a Diameter stream uses a Session-ID to connect parts of the same flow; IKEv2 uses SPIs; PANA message headers have a Session Identifier field.  Adding an interpretation to the Identity field for reasons of concurrency would add complexity, but not functionality.  In line with this reasoning, multiple SASL authentications within the same EAP session are not supported.</p>
<p id="rfc.section.4.p.3">SASL requires a service name to be specified for use with GSSAPI.  This service name is easy to establish when protocols serve a specific application, but EAP is more general.  Therefore, the responsibility of selecting a service name must in general be specific to the EAP Lower Layer.  The name TBD:net is allocated as a default service name for the EAP Lower Layer protocols 1-7 and 9, as registered by IANA.  The EAP peer drives this choice.  When carried over RADIUS or Diameter, the EAP-Lower-Layer attribute [Section 7.2 of <a href="#RFC6677">[RFC6677]</a>] SHOULD be used.  For EAP Lower Layer protocol 8 (GSS-API), this specification cannot assign a default service name, because it is another generic lower layer.  Also, it may be better to avoid the SASL method GSSAPI when GSSAPI is the EAP Lower Layer.</p>
<p id="rfc.section.4.p.4">SASL requires a standard syntax and semantics, as well as normalisation rules, for authorisation identifiers.  In general, this depends on the EAP Lower Layer.  We can provide a default mechanism, however, which is of use to customary EAP Lower Layers such as PPP and 802.1x.  This is either the format of a Fully Qualified Domain Name [Section 5.2 of <a href="#RFC1594">[RFC1594]</a>] or a Network Access Identitifier <a href="#RFC7542">[RFC7542]</a>.</p>
<p id="rfc.section.4.p.5">TODO: channel binding, like in GS2-KRB5-PLUS and SCRAM-SHA1-PLUS requires a notion of the TLS channel; relaying it to a backend over EAP is not helpful; an attribute such as the NAS-Port-Instance may help?</p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#keying" id="keying">Key Derivation</a></h1>
<p id="rfc.section.5.p.1">There are two mechanisms that may be used for key derivation; either directly using the SASL credentials, or by using an EAP-TTLS wrapper around EAP-SASL.  When both are used, EAP-TTLS is the RECOMMENDED choice on account of its stronger security.</p>
<h1 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a> <a href="#keying-eapsasl" id="keying-eapsasl">Keying under EAP-SASL</a></h1>
<p id="rfc.section.5.1.p.1">Keying under SASL uses what shared secret is available in order to generate MSK/EMSK <a href="#RFC5247">[RFC5247]</a> for use in the EAP Lower Layer.  To enable this additional function, the shared secret MUST NOT be passed over EAP-SASL in an unprotected form, not even when protected with EAP-TTLS, meaning that the SASL PLAIN and OAUTHBEARER mechanisms are barred.  Some form of active use of the credential MUST pass over EAP-SASL, meaning that the SASL ANONYMOUS and EXTERNAL mechanisms are also barred.  Furthermore, the EAP-SASL method MUST have exchanged at least 16 bytes from each side in precisely one *RANDOMSALT instruction exchange.</p>
<p id="rfc.section.5.1.p.2">SASL mechanisms that can negotiate a security layer are RECOMMENDED to use this facility to find a sesssion key for key generation under SASL; other SASL mechanisms may have to use a shared key that is fixed as the session key.  One SASL mechanism that SHOULD negotiate a session key when used is GSSAPI with Kerberos5.</p>
<p id="rfc.section.5.1.p.3">The session key is used in a variation on the EAP-TTLS computation:</p>
<pre>
KeyMaterial = PRF-128 (eap_sasl.session_key,
                       "EAP-SASL keying material",
                       peer.RANDOMSALT + server.RANDOMSALT)

MSK  = KeyMaterial [ 0.. 63]

EMSK = KeyMaterial [64..127]
</pre>
<p id="rfc.section.5.1.p.4">The PRF-128 function is as used with EAP-TTLS [Section 7.8 of <a href="#RFC5281">[RFC5281]</a>].  Note the reversed order of the random material relative to TLS; as for EAP-TLS and EAP-TTLS, this intends to avoid clashes with similar TLS computations.  The EMSK may be used to derive root keys <a href="#RFC5295">[RFC5295]</a>.</p>
<h1 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2.</a> <a href="#keying-eapttls" id="keying-eapttls">Keying under EAP-TTLS</a></h1>
<p id="rfc.section.5.2.p.1">Some SASL mechanisms cannot reliably be sent in plaintext; in such cases, it is customary to run the containing protocol in a secure transport such as TLS.  There is an EAP mechanism to do just that, namely EAP-TTLS <a href="#RFC5281">[RFC5281]</a>.  The EAP-SASL flow can be embedded in EAP-TTLS if such is required.</p>
<p id="rfc.section.5.2.p.2">Wrapping EAP-SASL inside EAP-TTLS is not only of interest for protecting the credential, but also in assuring that the response is sent to an authentic server, thus mitigating man-in-the-middle attacks.  Finally, EAP-TTLS can be useful because it standardises a key that can be used to encrypt further traffic, for instance under the WPA2 technology.</p>
<p id="rfc.section.5.2.p.3">Finally, when EAP-TTLS wrapping is used, there is the option of using Keying Material Export <a href="#RFC5705">[RFC5705]</a> to derive a key.  Unlike the MSK/EMSK that EAP-TTLS shares with the EAP authenticator to establish one-hop encryption, this constitutes a key that reaches out to the site that performed authentication.  Such applications use the ASCII label "EAP-SASL key derivation" (without the quotes).  The context value is only provided when EAP-SASL has exchanged *RANDOMSALT, in which case it is set to the concatenation of the peer and server random salt bytes.</p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#efficiency" id="efficiency">Efficiency Considerations</a></h1>
<p id="rfc.section.6.p.1">EAP is a lock-stepped request/response protocol, which means that there are no window buffers, and so efficiency can be low, especially when EAP-SASL is run over EAP-TTLS.  This is agravated in setups with a backend AAA server, especially when the backend is dynamically switched to a remote site.  Since EAP is mostly used to bootstrap network connections, rather than consistently recurring events, this is usually considered acceptable.</p>
<p id="rfc.section.6.p.2">Some EAP-SASL mechanisms or encapsulations may derive an end-to-end secret key that cannot be observed by intermediates.  This may speed up further processing, for instance for the setup of IPsec shared keys.</p>
<p id="rfc.section.6.p.3">SASL is present in many protocols, each of which could be candidates for backend authentication.  Many protocols (like IMAP and SMTP) do not allow reuse of connections for multiple authentications.  LDAP does allow such reuse, and overcomes MTU-caused fragmentation, but only one LDAP bind interaction can be active at any time.  The best performance is to be expected from the multiplexed authentication sessions over AAA protocols.  Of these, Diameter over SCTP is likely the most efficient, because it (1) avoids head-of-line blocking by sending out-of-order, (2) avoids resend logic and timers with reliable delivery, (3) avoids fragmentation by allowing large user messages, (4) handles resends at the protocol level, and can notice intermediate frames being dropped, (5) can combine multiple small messages in one network packet.</p>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#privacy" id="privacy">Privacy Considerations</a></h1>
<p id="rfc.section.7.p.1">The EAP-SASL mechanism is as private as SASL is.  So, when a user identity is revealed in plaintext SASL, then it will also be visible in plaintext EAP-SASL.  A layer of EAP-TTLS can remedy any problems with this.</p>
<p id="rfc.section.7.p.2">In addition, EAP-SASL may be transported with a so-called outer identity.  If this is the case, then additional data may leak from there too.  The customary approach is then to avoid mentioning the username portion, but just the realm, as in @example.com User-Id attributes.</p>
<h1 id="rfc.section.8"><a href="#rfc.section.8">8.</a> <a href="#security" id="security">Security Considerations</a></h1>
<p id="rfc.section.8.p.1">Anything that cannot travel securely in plaintext over SASL, also cannot travel securely over EAP-SASL.  Where needed, a layer of EAP-TTLS can be used to remedy that.</p>
<p id="rfc.section.8.p.2">SASL mechanisms are not only subjected to public showing of credentials, but also to the danger of entering in a challenge/response interaction with an unverified peer, which may then function as a man in the middle.  Such men are usually called Eve.  A wrapper of EAP-TTLS can remedy this, by supplying end-to-end server authenticity.</p>
<p id="rfc.section.8.p.3">Whether plaintext suffices for EAP-SASL depends largely on the intermediate network; when routing to an external network it is almost certainly not a good idea but when routing to a nearby AAA backend within a secure network premises or over a secure AAA backlink it can be made secure.</p>
<p id="rfc.section.8.p.4">When producing MSK/EMSK from EAP-SASL, it is vital to have good entropy from all the available places: the session key, the EAP peer and EAP server should all provide an ample amount of entropy.  The *RANDOMSALT provided by EAP peer and server helps each side to direct scattering of the MSK/EMSK, and thereby influence that other parties could attempt replay attacks; but regardless of the quality and size of these *RANDOMSALT fragments, the session key is still subject to password attacks upon observation of the MSK/EMSK and must therefore be carefully selected; this is especially a concern when the session key is just a shared secret, such as a password, which may be used without change over a prolonged period.</p>
<h1 id="rfc.section.9"><a href="#rfc.section.9">9.</a> <a href="#iana" id="iana">IANA Considerations</a></h1>
<p id="rfc.section.9.p.1">This specification requests the registration of a Method Type in the Extensible Authentication Protocol (EAP) Registry, from the range granted through the Designated Expert with Specification Required procedure.  IANA has assigned TBD to the EAP method specified herein.</p>
<p id="rfc.section.9.p.2">This specification defines an additional entry in the registry "Generic Security Service Application Program Interface (GSSAPI)/Kerberos/Simple Authentication and Security Layer (SASL) Service Names" namely: </p>
<pre>
Service Name: net
Usage:        authentication for network access
Reference:    TBD:this specification
</pre>
<p id="rfc.section.9.p.3">This specification defines an entry in the TLS Exporter Label registry, referencing this specification, namely: EAP-SASL key derivation</p>
<h1 id="rfc.references"><a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC1594">[RFC1594]</b>
      </td>
      <td class="top"><a>Marine, A.</a>, <a>Reynolds, J.</a> and <a>G. Malkin</a>, "<a href="http://tools.ietf.org/html/rfc1594">FYI on Questions and Answers - Answers to Commonly asked "New Internet User" Questions</a>", RFC 1594, DOI 10.17487/RFC1594, March 1994.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2284">[RFC2284]</b>
      </td>
      <td class="top"><a>Blunk, L.</a> and <a>J. Vollbrecht</a>, "<a href="http://tools.ietf.org/html/rfc2284">PPP Extensible Authentication Protocol (EAP)</a>", RFC 2284, DOI 10.17487/RFC2284, March 1998.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3748">[RFC3748]</b>
      </td>
      <td class="top"><a>Aboba, B.</a>, <a>Blunk, L.</a>, <a>Vollbrecht, J.</a>, <a>Carlson, J.</a> and <a>H. Levkowetz</a>, "<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>", RFC 3748, DOI 10.17487/RFC3748, June 2004.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4422">[RFC4422]</b>
      </td>
      <td class="top"><a>Melnikov, A.</a> and <a>K. Zeilenga</a>, "<a href="http://tools.ietf.org/html/rfc4422">Simple Authentication and Security Layer (SASL)</a>", RFC 4422, DOI 10.17487/RFC4422, June 2006.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5247">[RFC5247]</b>
      </td>
      <td class="top"><a>Aboba, B.</a>, <a>Simon, D.</a> and <a>P. Eronen</a>, "<a href="http://tools.ietf.org/html/rfc5247">Extensible Authentication Protocol (EAP) Key Management Framework</a>", RFC 5247, DOI 10.17487/RFC5247, August 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5281">[RFC5281]</b>
      </td>
      <td class="top"><a>Funk, P.</a> and <a>S. Blake-Wilson</a>, "<a href="http://tools.ietf.org/html/rfc5281">Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)</a>", RFC 5281, DOI 10.17487/RFC5281, August 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5295">[RFC5295]</b>
      </td>
      <td class="top"><a>Salowey, J.</a>, <a>Dondeti, L.</a>, <a>Narayanan, V.</a> and <a>M. Nakhjiri</a>, "<a href="http://tools.ietf.org/html/rfc5295">Specification for the Derivation of Root Keys from an Extended Master Session Key (EMSK)</a>", RFC 5295, DOI 10.17487/RFC5295, August 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5705">[RFC5705]</b>
      </td>
      <td class="top"><a>Rescorla, E.</a>, "<a href="http://tools.ietf.org/html/rfc5705">Keying Material Exporters for Transport Layer Security (TLS)</a>", RFC 5705, DOI 10.17487/RFC5705, March 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6677">[RFC6677]</b>
      </td>
      <td class="top"><a>Hartman, S.</a>, <a>Clancy, T.</a> and <a>K. Hoeper</a>, "<a href="http://tools.ietf.org/html/rfc6677">Channel-Binding Support for Extensible Authentication Protocol (EAP) Methods</a>", RFC 6677, DOI 10.17487/RFC6677, July 2012.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7542">[RFC7542]</b>
      </td>
      <td class="top"><a>DeKok, A.</a>, "<a href="http://tools.ietf.org/html/rfc7542">The Network Access Identifier</a>", RFC 7542, DOI 10.17487/RFC7542, May 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.ietf-kitten-iakerb">[I-D.ietf-kitten-iakerb]</b>
      </td>
      <td class="top"><a>Kaduk, B.</a>, <a>Schaad, J.</a>, <a>Zhu, L.</a> and <a>J. Altman</a>, "<a href="http://tools.ietf.org/html/draft-ietf-kitten-iakerb-03">Initial and Pass Through Authentication Using Kerberos V5 and the GSS- API (IAKERB)</a>", Internet-Draft draft-ietf-kitten-iakerb-03, March 2017.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">10.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC2865">[RFC2865]</b>
      </td>
      <td class="top"><a>Rigney, C.</a>, <a>Willens, S.</a>, <a>Rubens, A.</a> and <a>W. Simpson</a>, "<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>", RFC 2865, DOI 10.17487/RFC2865, June 2000.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5191">[RFC5191]</b>
      </td>
      <td class="top"><a>Forsberg, D.</a>, <a>Ohba, Y.</a>, <a>Patil, B.</a>, <a>Tschofenig, H.</a> and <a>A. Yegin</a>, "<a href="http://tools.ietf.org/html/rfc5191">Protocol for Carrying Authentication for Network Access (PANA)</a>", RFC 5191, DOI 10.17487/RFC5191, May 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6733">[RFC6733]</b>
      </td>
      <td class="top"><a>Fajardo, V.</a>, <a>Arkko, J.</a>, <a>Loughney, J.</a> and <a>G. Zorn</a>, "<a href="http://tools.ietf.org/html/rfc6733">Diameter Base Protocol</a>", RFC 6733, DOI 10.17487/RFC6733, October 2012.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7055">[RFC7055]</b>
      </td>
      <td class="top"><a>Hartman, S.</a> and <a>J. Howlett</a>, "<a href="http://tools.ietf.org/html/rfc7055">A GSS-API Mechanism for the Extensible Authentication Protocol</a>", RFC 7055, DOI 10.17487/RFC7055, December 2013.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7296">[RFC7296]</b>
      </td>
      <td class="top"><a>Kaufman, C.</a>, <a>Hoffman, P.</a>, <a>Nir, Y.</a>, <a>Eronen, P.</a> and <a>T. Kivinen</a>, "<a href="http://tools.ietf.org/html/rfc7296">Internet Key Exchange Protocol Version 2 (IKEv2)</a>", STD 79, RFC 7296, DOI 10.17487/RFC7296, October 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.vanrein-eap-kerberos">[I-D.vanrein-eap-kerberos]</b>
      </td>
      <td class="top"><a>Rein, R.</a>, "<a href="http://tools.ietf.org/html/draft-vanrein-eap-kerberos-00">Kerberos in the Extensible Authentication Protocol (EAP-Kerberos)</a>", Internet-Draft draft-vanrein-eap-kerberos-00, March 2016.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Author's Address</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Rick van Rein</span> 
	  <span class="n hidden">
		<span class="family-name">Van Rein</span>
	  </span>
	</span>
	<span class="org vcardline">ARPA2.net</span>
	<span class="adr">
	  <span class="vcardline">Haarlebrink 5</span>

	  <span class="vcardline">
		<span class="locality">Enschede</span>,  
		<span class="region">Overijssel</span> 
		<span class="code">7544 WP</span>
	  </span>
	  <span class="country-name vcardline">The Netherlands</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:rick@openfortress.nl">rick@openfortress.nl</a></span>

  </address>
</div>

</body>
</html>
